"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[3040],{3040:(L,h,r)=>{r.r(h),r.d(h,{Tab4Page:()=>N});var m=r(467),g=r(3273),p=r(177),u=r(4341),a=r(2220),T=r(5079),c=r(5873),f=r(6946),j=r(9853),b=r(9350),e=r(4438),E=r(8287),C=r(9967);const P=()=>[0,.5,1];function F(o,l){1&o&&(e.j41(0,"div")(1,"ion-note",41),e.EFF(2,"Username is required."),e.k0s()())}function M(o,l){1&o&&(e.j41(0,"div")(1,"ion-note",41),e.EFF(2,"Name is required."),e.k0s()())}function R(o,l){if(1&o){const s=e.RV6();e.j41(0,"ion-header")(1,"ion-toolbar")(2,"ion-title"),e.EFF(3,"Edit Profile"),e.k0s()()(),e.j41(4,"ion-content",18)(5,"form",35,2),e.bIt("ngSubmit",function(){e.eBV(s);const n=e.XpG();return e.Njj(n.updateProfile())}),e.j41(7,"ion-list",18)(8,"ion-item",8)(9,"ion-input",36),e.bIt("change",function(n){e.eBV(s);const i=e.XpG();return e.Njj(i.uploadFile(n))}),e.k0s()(),e.j41(10,"ion-item")(11,"ion-input",37,3),e.mxI("ngModelChange",function(n){e.eBV(s);const i=e.XpG();return e.DH7(i.editableUserDetails.username,n)||(i.editableUserDetails.username=n),e.Njj(n)}),e.k0s()(),e.DNE(13,F,3,0,"div",32),e.j41(14,"ion-item")(15,"ion-input",38,4),e.mxI("ngModelChange",function(n){e.eBV(s);const i=e.XpG();return e.DH7(i.editableUserDetails.name,n)||(i.editableUserDetails.name=n),e.Njj(n)}),e.k0s()(),e.DNE(17,M,3,0,"div",32),e.j41(18,"ion-item")(19,"ion-textarea",39),e.mxI("ngModelChange",function(n){e.eBV(s);const i=e.XpG();return e.DH7(i.editableUserDetails.bio,n)||(i.editableUserDetails.bio=n),e.Njj(n)}),e.k0s()()()()(),e.j41(20,"ion-footer")(21,"ion-button",40),e.bIt("click",function(){e.eBV(s);const n=e.XpG();return e.Njj(n.updateProfile())}),e.EFF(22," Update "),e.k0s()()}if(2&o){const s=e.sdS(6),t=e.sdS(12),n=e.sdS(16),i=e.XpG();e.R7$(11),e.R50("ngModel",i.editableUserDetails.username),e.R7$(2),e.Y8G("ngIf",t.invalid&&(t.dirty||t.touched)),e.R7$(2),e.R50("ngModel",i.editableUserDetails.name),e.R7$(2),e.Y8G("ngIf",n.invalid&&(n.dirty||n.touched)),e.R7$(2),e.R50("ngModel",i.editableUserDetails.bio),e.R7$(2),e.Y8G("disabled",s.invalid)}}function v(o,l){if(1&o){const s=e.RV6();e.j41(0,"ion-col",44)(1,"ion-card",45),e.nrm(2,"ion-img",46),e.j41(3,"div",47)(4,"ion-button",48),e.nrm(5,"ion-icon",49),e.j41(6,"span"),e.EFF(7),e.k0s()(),e.j41(8,"ion-button",50),e.bIt("click",function(){const n=e.eBV(s).$implicit,i=e.XpG(3);return e.Njj(i.openCommentModal(n.id))}),e.nrm(9,"ion-icon",51),e.k0s()()()()}if(2&o){const s=l.$implicit;e.R7$(2),e.Y8G("src",s.postLink),e.R7$(5),e.JRh(s.likes)}}function k(o,l){if(1&o&&(e.qex(0),e.DNE(1,v,10,2,"ion-col",43),e.bVm()),2&o){const s=e.XpG(2);e.R7$(),e.Y8G("ngForOf",s.ThisUserPosts)}}function O(o,l){if(1&o&&(e.j41(0,"ion-row"),e.DNE(1,k,2,1,"ng-container",42),e.k0s()),2&o){const s=e.XpG(),t=e.sdS(70);e.R7$(),e.Y8G("ngIf",s.ThisUserPosts&&s.ThisUserPosts.length>0)("ngIfElse",t)}}function U(o,l){1&o&&(e.j41(0,"ion-row")(1,"ion-col",52)(2,"p"),e.EFF(3,"No posts available in Your Posts."),e.k0s()()())}function I(o,l){if(1&o&&(e.j41(0,"ion-col",44)(1,"ion-card",53),e.nrm(2,"ion-img",46),e.j41(3,"ion-badge",54),e.EFF(4),e.k0s()()()),2&o){const s=l.$implicit;e.R7$(2),e.Y8G("src",s.postLink),e.R7$(2),e.SpI("@ ",s.userName,"")}}function y(o,l){if(1&o&&(e.j41(0,"ion-row"),e.DNE(1,I,5,2,"ion-col",43),e.k0s()),2&o){const s=e.XpG();e.R7$(),e.Y8G("ngForOf",s.savedPost)}}function B(o,l){if(1&o&&(e.j41(0,"ion-list")(1,"ion-item")(2,"ion-avatar",59),e.nrm(3,"img",60),e.k0s(),e.j41(4,"ion-label")(5,"p"),e.EFF(6),e.k0s(),e.EFF(7),e.k0s()()()),2&o){const s=l.$implicit;e.R7$(3),e.Y8G("src",s.profilePic,e.B4B),e.R7$(3),e.JRh(s.userName),e.R7$(),e.SpI(" ",s.comment," ")}}function S(o,l){if(1&o){const s=e.RV6();e.j41(0,"ion-header")(1,"ion-toolbar")(2,"ion-title"),e.EFF(3,"Comments"),e.k0s()()(),e.j41(4,"ion-content"),e.DNE(5,B,8,3,"ion-list",55),e.k0s(),e.j41(6,"ion-footer")(7,"ion-toolbar")(8,"form",35,5),e.bIt("ngSubmit",function(){e.eBV(s);const n=e.XpG();return e.Njj(n.addComment(n.selectedPost))}),e.j41(10,"ion-item")(11,"ion-input",56),e.mxI("ngModelChange",function(n){e.eBV(s);const i=e.XpG();return e.DH7(i.comments,n)||(i.comments=n),e.Njj(n)}),e.k0s(),e.j41(12,"ion-buttons",11)(13,"ion-button",57),e.nrm(14,"ion-icon",58),e.k0s()()()()()()}if(2&o){const s=e.sdS(9),t=e.XpG();e.R7$(5),e.Y8G("ngForOf",t.postComments),e.R7$(6),e.R50("ngModel",t.comments),e.R7$(2),e.Y8G("disabled",s.invalid)}}let N=(()=>{var o;class l{constructor(t,n,i,_,d){this.modalController=t,this.firebaseService=n,this.storage=i,this.firestore=_,this.loadingController=d,this.userDetails=null,this.editableUserDetails={username:"",name:"",profilePic:"",bio:""},this.selectedFile=null,this.userName="",this.segmentValue="Your-Posts",this.ThisUserPosts=null,this.isModalOpen=!1,this.postComments=null,this.paletteToggle=!1,this.logoutButtons=[{text:"Cancel",role:"cancel"},{text:"Confirm",role:"confirm",handler:()=>{this.logout()}}],(0,T.a)({logOutOutline:c.z_V,power:c.ypn,settingsOutline:c.s8q,heart:c.Hmd,chatbubbleOutline:c.DD4,sendOutline:c.NF$,cogOutline:c.Szh,pencilOutline:c.SNL,location:c.C5I,heartOutline:c.neQ,bookmarkOutline:c.dm8,heartCircleOutline:c.bIN,logOut:c.jeD})}doRefresh(t){var n=this;setTimeout((0,m.A)(function*(){yield n.ngOnInit(),t.target.complete()}),3e3)}presentLoader(){var t=this;return(0,m.A)(function*(){const n=yield t.loadingController.create({spinner:"lines-sharp",mode:"ios"});return yield n.present(),n})()}dismissLoader(t){return(0,m.A)(function*(){yield t.dismiss()})()}ngOnInit(){var t=this;return(0,m.A)(function*(){const n=yield t.presentLoader();try{const _=yield t.firebaseService.getCurrentUser();_&&(t.userDetails=yield t.firebaseService.loadUserDetail(_.uid),t.editableUserDetails.name=t.userDetails.name,t.editableUserDetails.username=t.userDetails.userName,t.editableUserDetails.bio=t.userDetails.bio,t.userName=`@${t.userDetails.userName}`,t.ThisUserPosts=yield t.firebaseService.loadSeparateUsersPost(_.uid),t.savedPost=yield t.firebaseService.loadSavedPost(_.uid))}catch{console.log("Error occurred while loading user details")}finally{yield t.dismissLoader(n)}const i=window.matchMedia("(prefers-color-scheme: dark)");t.initializeDarkPalette(i.matches),i.addEventListener("change",_=>t.initializeDarkPalette(_.matches))})()}initializeDarkPalette(t){this.paletteToggle=t,this.toggleDarkPalette(t)}toggleChange(t){this.toggleDarkPalette(t.detail.checked)}toggleDarkPalette(t){document.documentElement.classList.toggle("ion-palette-dark",t)}uploadFile(t){this.selectedFile=t.target.files[0],console.log(this.selectedFile)}updateProfile(){var t=this;return(0,m.A)(function*(){const n=yield t.presentLoader(),i=yield t.firebaseService.getCurrentUser();if(i){const _=i.uid;if(t.selectedFile){const D=(0,j.KR)(t.storage,`profile-picture/${_}`);yield(0,f.D)(D,t.selectedFile);const Y=yield(0,f.qk)(D);t.editableUserDetails.profilePic=Y}else t.editableUserDetails.profilePic=t.userDetails.profilePic;const d=(0,g.rJ)(t.firestore,"users"),G=(0,g.P)(d,(0,g._M)("uid","==",_)),$=(yield(0,g.GG)(G)).docs[0].ref;yield(0,g.mZ)($,{name:t.editableUserDetails.name,userName:t.editableUserDetails.username,bio:t.editableUserDetails.bio,profilePic:t.editableUserDetails.profilePic}),console.log("Profile updated!"),yield t.dismissModal(),yield t.ngOnInit()}yield t.dismissLoader(n)})()}dismissModal(){var t=this;return(0,m.A)(function*(){yield t.modalController.dismiss()})()}segmentChange(t){this.segmentValue=t.detail.value,console.log(t.detail.value)}openCommentModal(t){var n=this;return(0,m.A)(function*(){n.selectedPost=t,n.isModalOpen=!0,n.firebaseService.loadComments(t),n.firebaseService.comments$.subscribe(i=>{n.postComments=i})})()}closeModal(){this.isModalOpen=!1,this.selectedPost=null,this.postComments=[]}addComment(t){var n=this;return(0,m.A)(function*(){const i=yield n.firebaseService.getCurrentUser();i&&(n.firebaseService.postComment(i.uid,t,n.comments),n.comments=""),n.firebaseService.loadComments(t)})()}logout(){this.firebaseService.logout()}}return(o=l).\u0275fac=function(t){return new(t||o)(e.rXU(b.W3),e.rXU(E.f),e.rXU(f.wc),e.rXU(C._7),e.rXU(b.Xi))},o.\u0275cmp=e.VBU({type:o,selectors:[["app-tab4"]],standalone:!0,features:[e.Jv_([b.W3]),e.aNF],decls:76,vars:17,consts:[["modal",""],["noPosts",""],["profileForm","ngForm"],["usernameInput","ngModel"],["nameInput","ngModel"],["f","ngForm"],["side","end","contentId","main-content"],["detail","true","id","edit-profile","lines","full"],["lines","full"],["justify","space-between","mode","ios",3,"ionChange","checked"],["slot","start",1,"ion-margin-start"],["slot","end"],["id","logoutAlert","color","danger"],["size","default","color","danger","name","log-out-outline"],["id","main-content",1,"ion-page"],[1,"ion-no-border"],["mode","md"],["name","settings-outline","size","large"],[1,"ion-padding"],["slot","fixed","mode","ios",3,"ionRefresh"],["refreshingSpinner","circles","refreshingText","Refreshing..."],[1,"ion-justify-content-center"],["size","auto",1,"ion-text-center"],[1,"avatar"],[3,"src"],["size","12",1,"ion-text-center"],[1,"ion-justify-content-around","ion-padding-vertical"],["size","4",1,"ion-text-center"],["trigger","edit-profile",3,"initialBreakpoint","breakpoints"],["value","Your-Posts","mode","ios",3,"ionChange"],["value","Your-Posts"],["value","Saved-Posts"],[4,"ngIf"],[3,"ionModalDidDismiss","isOpen","initialBreakpoint","breakpoints"],["trigger","logoutAlert","header","Logout Confirmation","mode","ios","message","Are you sure you want to logout?",3,"buttons"],[3,"ngSubmit"],["type","file","label","Profile picture","color","light",3,"change"],["label","Username","labelPlacement","floating","required","","name","username",3,"ngModelChange","ngModel"],["label","Name","labelPlacement","floating","required","","name","name",3,"ngModelChange","ngModel"],["label","Bio","labelPlacement","floating","name","bio","required","",3,"ngModelChange","ngModel"],["expand","block","color","tertiary","type","submit",3,"click","disabled"],["color","danger"],[4,"ngIf","ngIfElse"],["size","6",4,"ngFor","ngForOf"],["size","6"],["mode","ios",1,"post-card"],[1,"post-image",3,"src"],[1,"post-overlay"],["fill","clear","color","dark"],["name","heart","color","primary"],["fill","clear",3,"click"],["color","dark","name","chatbubble-outline"],["size","12",1,"ion-justify-content-center"],["mode","ios",1,"saved-post-card"],["color","warning",1,"post-user-badge"],[4,"ngFor","ngForOf"],["placeholder","Write comments...","name","comment","required","",3,"ngModelChange","ngModel"],["type","submit",3,"disabled"],["name","send-outline","color","medium"],["slot","start"],["alt","",3,"src"]],template:function(t,n){if(1&t){const i=e.RV6();e.j41(0,"ion-menu",6)(1,"ion-header")(2,"ion-toolbar")(3,"ion-title"),e.EFF(4,"Settings"),e.k0s()()(),e.j41(5,"ion-content")(6,"ion-list")(7,"ion-item",7),e.EFF(8,"Edit Profile"),e.k0s(),e.j41(9,"ion-item",8)(10,"ion-toggle",9),e.bIt("ionChange",function(d){return e.eBV(i),e.Njj(n.toggleChange(d))}),e.EFF(11,"Dark Mode"),e.k0s()()()(),e.j41(12,"ion-footer")(13,"ion-toolbar")(14,"ion-note",10),e.EFF(15,"Vibo v1.0"),e.k0s(),e.j41(16,"ion-buttons",11)(17,"ion-button",12),e.EFF(18,"Logout"),e.nrm(19,"ion-icon",13),e.k0s()()()()(),e.j41(20,"div",14)(21,"ion-header",15)(22,"ion-toolbar",16)(23,"ion-title"),e.EFF(24),e.k0s(),e.j41(25,"ion-buttons",11)(26,"ion-menu-toggle")(27,"ion-button"),e.nrm(28,"ion-icon",17),e.k0s()()()()(),e.j41(29,"ion-content",18)(30,"ion-refresher",19),e.bIt("ionRefresh",function(d){return e.eBV(i),e.Njj(n.doRefresh(d))}),e.nrm(31,"ion-refresher-content",20),e.k0s(),e.nrm(32,"ion-loading"),e.j41(33,"ion-grid")(34,"ion-row",21)(35,"ion-col",22)(36,"ion-avatar",23),e.nrm(37,"img",24),e.k0s()()(),e.j41(38,"ion-row",21)(39,"ion-col",25)(40,"ion-text")(41,"h2"),e.EFF(42),e.k0s(),e.j41(43,"p"),e.EFF(44),e.k0s()()()(),e.j41(45,"ion-row",26)(46,"ion-col",27)(47,"ion-text"),e.EFF(48,"Followers"),e.k0s(),e.j41(49,"p"),e.EFF(50),e.k0s()(),e.j41(51,"ion-col",27)(52,"ion-text"),e.EFF(53,"Following"),e.k0s(),e.j41(54,"p"),e.EFF(55),e.k0s()()()(),e.j41(56,"ion-modal",28,0),e.DNE(58,R,23,6,"ng-template"),e.k0s(),e.j41(59,"ion-toolbar")(60,"ion-segment",29),e.bIt("ionChange",function(d){return e.eBV(i),e.Njj(n.segmentChange(d))}),e.j41(61,"ion-segment-button",30)(62,"ion-label"),e.EFF(63,"Your Posts"),e.k0s()(),e.j41(64,"ion-segment-button",31)(65,"ion-label"),e.EFF(66,"Saved Posts"),e.k0s()()()(),e.j41(67,"ion-grid"),e.DNE(68,O,2,2,"ion-row",32)(69,U,4,0,"ng-template",null,1,e.C5r)(71,y,2,1,"ion-row",32),e.k0s(),e.j41(72,"ion-modal",33,0),e.bIt("ionModalDidDismiss",function(){return e.eBV(i),e.Njj(n.closeModal())}),e.DNE(74,S,15,3,"ng-template"),e.k0s(),e.nrm(75,"ion-alert",34),e.k0s()()}2&t&&(e.R7$(10),e.Y8G("checked",n.paletteToggle),e.R7$(14),e.JRh(n.userName),e.R7$(13),e.Y8G("src",(null==n.userDetails?null:n.userDetails.profilePic)||"../../assets/profile.webp",e.B4B),e.R7$(5),e.JRh(null==n.userDetails?null:n.userDetails.name),e.R7$(2),e.JRh(null==n.userDetails?null:n.userDetails.bio),e.R7$(6),e.JRh(null==n.userDetails?null:n.userDetails.followersCount),e.R7$(5),e.JRh(null==n.userDetails?null:n.userDetails.followingCount),e.R7$(),e.Y8G("initialBreakpoint",1)("breakpoints",e.lJ4(15,P)),e.R7$(12),e.Y8G("ngIf","Your-Posts"===n.segmentValue),e.R7$(3),e.Y8G("ngIf","Saved-Posts"===n.segmentValue),e.R7$(),e.Y8G("isOpen",n.isModalOpen)("initialBreakpoint",1)("breakpoints",e.lJ4(16,P)),e.R7$(3),e.Y8G("buttons",n.logoutButtons))},dependencies:[a.BY,a.rQ,a.Zy,a.In,a.KW,a.b_,a.hU,a.ln,a.lO,a.Ki,a.To,a.QW,a.JI,a.nf,a.eP,a.Gp,a.nc,a.IO,a.M0,a.Jm,a.$w,u.YN,u.qT,u.BC,u.cb,u.YS,u.vS,u.cV,p.MD,p.Sq,p.bT,a.Sb,a.iq,a.mC,a.uz,a.he,a.W9,a.eU,a.BC,a.ai,a.oS,a.cA],styles:[".avatar[_ngcontent-%COMP%]{width:100px;height:100px}.post-image[_ngcontent-%COMP%]{height:150px;object-fit:cover}.saved-post-card[_ngcontent-%COMP%]{position:relative}.post-user-badge[_ngcontent-%COMP%]{position:absolute;bottom:5px}"]}),l})()}}]);