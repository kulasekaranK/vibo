"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[9444],{9444:(U,E,p)=>{p.r(E),p.d(E,{LoginPage:()=>u});var f=p(467),h=p(177),_=p(4341),n=p(2220),v=p(6766),e=p(4438),C=p(8287),D=p(9350);const y=()=>["/register"];function M(s,c){1&s&&(e.j41(0,"p"),e.EFF(1,"Email is required!"),e.k0s())}function O(s,c){1&s&&(e.j41(0,"p"),e.EFF(1,"Please enter a valid email!"),e.k0s())}function o(s,c){if(1&s&&(e.j41(0,"ion-item",6)(1,"ion-label",14),e.DNE(2,M,2,0,"p",15)(3,O,2,0,"p",15),e.k0s()()),2&s){e.XpG();const l=e.sdS(15);e.R7$(2),e.Y8G("ngIf",null==l.errors?null:l.errors.required),e.R7$(),e.Y8G("ngIf",null==l.errors?null:l.errors.email)}}function t(s,c){1&s&&(e.j41(0,"p"),e.EFF(1,"Password is required!"),e.k0s())}function r(s,c){1&s&&(e.j41(0,"p"),e.EFF(1," Password must be at least 6 characters long! "),e.k0s())}function a(s,c){if(1&s&&(e.j41(0,"ion-item",6)(1,"ion-label"),e.DNE(2,t,2,0,"p",15)(3,r,2,0,"p",15),e.k0s()()),2&s){e.XpG();const l=e.sdS(19);e.R7$(2),e.Y8G("ngIf",null==l.errors?null:l.errors.required),e.R7$(),e.Y8G("ngIf",null==l.errors?null:l.errors.minlength)}}let u=(()=>{var s;class c{constructor(i,d,g){this.firebaseService=i,this.router=d,this.toastController=g,this.email="",this.password=""}login(){var i=this;return(0,f.A)(function*(){try{const g=(yield i.firebaseService.loginUser(i.email,i.password)).user;yield i.firebaseService.reloadUser(g),i.firebaseService.isEmailVerified(g)?i.router.navigate(["/"],{replaceUrl:!0}):yield(yield i.toastController.create({message:"Please verify your email before logging in.",duration:5e3,position:"top"})).present()}catch{yield(yield i.toastController.create({message:"Login failed: Invalid credentials!",duration:5e3,position:"top"})).present()}})()}ngOnInit(){}}return(s=c).\u0275fac=function(i){return new(i||s)(e.rXU(C.f),e.rXU(v.Ix),e.rXU(D.K_))},s.\u0275cmp=e.VBU({type:s,selectors:[["app-login"]],standalone:!0,features:[e.aNF],decls:33,vars:7,consts:[["loginForm","ngForm"],["emailCtrl","ngModel"],["passwordCtrl","ngModel"],["mode","ios"],[1,"ion-padding"],[1,"ion-text-center"],["lines","none"],["size","large","mode","md",1,"ion-text-center"],["label","Email","labelPlacement","floating","type","email","name","email","required","","email","",3,"ngModelChange","ngModel"],["lines","none",4,"ngIf"],["label","Password","type","password","labelPlacement","floating","name","password","required","","minlength","6",3,"ngModelChange","ngModel"],["routerLink","/forgot-password"],["color","primary","size","default","expand","block","type","submit",3,"click","disabled"],[3,"routerLink"],["color","danger"],[4,"ngIf"]],template:function(i,d){if(1&i){const g=e.RV6();e.j41(0,"ion-content",3)(1,"ion-header",4)(2,"ion-label",5)(3,"h1"),e.EFF(4,"vibo"),e.k0s(),e.j41(5,"p"),e.EFF(6,"Feel the Vibe, Share the Moment"),e.k0s()()(),e.j41(7,"form",null,0)(9,"ion-list",4)(10,"ion-item",6)(11,"ion-title",7),e.EFF(12,"Login"),e.k0s()(),e.j41(13,"ion-item")(14,"ion-input",8,1),e.mxI("ngModelChange",function(m){return e.eBV(g),e.DH7(d.email,m)||(d.email=m),e.Njj(m)}),e.k0s()(),e.DNE(16,o,4,2,"ion-item",9),e.j41(17,"ion-item")(18,"ion-input",10,2),e.mxI("ngModelChange",function(m){return e.eBV(g),e.DH7(d.password,m)||(d.password=m),e.Njj(m)}),e.k0s()(),e.DNE(20,a,4,2,"ion-item",9),e.j41(21,"ion-item",6)(22,"ion-label")(23,"p",11),e.EFF(24,"Forgot Password?"),e.k0s()()(),e.j41(25,"ion-item",6)(26,"ion-button",12),e.bIt("click",function(){return e.eBV(g),e.Njj(d.login())}),e.EFF(27,"Login"),e.k0s()(),e.j41(28,"div",4)(29,"ion-label"),e.EFF(30,"Don't have an account? "),e.j41(31,"a",13),e.EFF(32,"Register"),e.k0s()()()()()()}if(2&i){const g=e.sdS(8),P=e.sdS(15),m=e.sdS(19);e.R7$(14),e.R50("ngModel",d.email),e.R7$(2),e.Y8G("ngIf",P.invalid&&P.touched),e.R7$(2),e.R50("ngModel",d.password),e.R7$(2),e.Y8G("ngIf",m.invalid&&m.touched),e.R7$(6),e.Y8G("disabled",g.invalid),e.R7$(5),e.Y8G("routerLink",e.lJ4(6,y))}},dependencies:[v.Wk,n.Jm,n.he,n.$w,n.nf,n.uz,n.W9,n.eU,n.BC,h.MD,h.bT,_.YN,_.qT,_.BC,_.cb,_.YS,_.xh,_.Dg,_.vS,_.cV],styles:["ion-content[_ngcontent-%COMP%]{--background: url(DarkBackground.3fc41cd67dc01970.png) no-repeat center center / cover}ion-content[_ngcontent-%COMP%]   ion-label[_ngcontent-%COMP%]{font-family:League Spartan,sans-serif}ion-content[_ngcontent-%COMP%]   ion-label[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{font-size:54px;color:#fff;margin-top:100px}ion-content[_ngcontent-%COMP%]   ion-list[_ngcontent-%COMP%]{position:fixed;bottom:0;width:100%;height:65vh;border-top-left-radius:46px;border-top-right-radius:46px;display:flex;flex-direction:column;align-items:center;justify-content:center}ion-content[_ngcontent-%COMP%]   ion-list[_ngcontent-%COMP%]   ion-item[_ngcontent-%COMP%]{width:100%}ion-content[_ngcontent-%COMP%]   ion-list[_ngcontent-%COMP%]   ion-button[_ngcontent-%COMP%]{margin:30px auto}"]}),c})()},8287:(U,E,p)=>{p.d(E,{f:()=>D});var f=p(467),h=p(4665),_=p(9967),n=p(3273),v=p(4412),e=p(4438),C=p(6766);let D=(()=>{var y;class M{constructor(o,t,r){this.auth=o,this.firestore=t,this.router=r,this.postsSubject=new v.t([]),this.posts$=this.postsSubject.asObservable(),this.commentsSubject=new v.t([]),this.comments$=this.commentsSubject.asObservable(),this.getCurrentUser()}createUser(o,t){return(0,h.eJ)(this.auth,o,t)}loginUser(o,t){return(0,h.x9)(this.auth,o,t)}storeUserDetails(o,t,r,a){var u=this;return(0,f.A)(function*(){const s=(0,_.rJ)(u.firestore,"users");return yield(0,_.gS)(s,{name:o,phoneNumber:t,email:r,uid:a,followersCount:0,followingCount:0,userName:o,profilePic:"https://media.istockphoto.com/id/1397556857/vector/avatar-13.jpg?s=612x612&w=0&k=20&c=n4kOY_OEVVIMkiCNOnFbCxM0yQBiKVea-ylQG62JErI="})})()}getCurrentUser(){return new Promise(o=>{(0,h.hg)(this.auth,t=>{t&&localStorage.setItem("user",JSON.stringify(t)),o(t)})})}loadUserDetail(o){var t=this;return(0,f.A)(function*(){try{const r=(0,_.rJ)(t.firestore,"users"),a=(0,n.P)(r,(0,n._M)("uid","==",o)),s=(yield(0,n.GG)(a)).docs.map(c=>c.data());return s.length>0?s[0]:null}catch(r){return console.error("Error loading user details:",r),null}})()}loadPost(){var o=this;return(0,f.A)(function*(){try{const t=(0,_.rJ)(o.firestore,"posts");(0,n.aQ)(t,function(){var r=(0,f.A)(function*(a){const u=yield Promise.all(a.docs.map(function(){var s=(0,f.A)(function*(c){const l=c.data(),i=yield o.loadUserDetail(l.uid);return{id:c.id,...l,...i}});return function(c){return s.apply(this,arguments)}}()));u.sort((s,c)=>{var l,i;const d=(null===(l=s.createdAt)||void 0===l?void 0:l.toMillis())||0;return((null===(i=c.createdAt)||void 0===i?void 0:i.toMillis())||0)-d}),o.postsSubject.next(u)});return function(a){return r.apply(this,arguments)}}())}catch(t){console.error("Error loading posts:",t)}})()}postComment(o,t,r){var a=this;return(0,f.A)(function*(){const u=(0,_.rJ)(a.firestore,"comments");return yield(0,_.gS)(u,{uid:o,postId:t,comment:r})})()}loadComments(o){var t=this;return(0,f.A)(function*(){try{const r=(0,_.rJ)(t.firestore,"comments"),a=(0,n.P)(r,(0,n._M)("postId","==",o));(0,n.aQ)(a,function(){var u=(0,f.A)(function*(s){const c=yield Promise.all(s.docs.map(function(){var l=(0,f.A)(function*(i){const d=i.data(),g=yield t.loadUserDetail(d.uid);return{...d,...g}});return function(i){return l.apply(this,arguments)}}()));t.commentsSubject.next(c)});return function(s){return u.apply(this,arguments)}}())}catch(r){console.error("Error loading comments:",r)}})()}loadSavedPost(o){var t=this;return(0,f.A)(function*(){const r=(0,_.rJ)(t.firestore,"savedPosts"),a=(0,n.P)(r,(0,n._M)("uid","==",o)),u=yield(0,n.GG)(a);return(yield Promise.all(u.docs.map(function(){var c=(0,f.A)(function*(l){const d=l.data().postId,g=(0,n.H9)(t.firestore,`posts/${d}`),P=yield(0,n.x7)(g);if(P.exists()){const m=P.data(),S=m.uid,b=yield t.loadUserDetail(S);return{...m,...b}}return console.log(`Post with ID ${d} does not exist.`),null});return function(l){return c.apply(this,arguments)}}()))).filter(c=>null!==c)})()}toggleLikePost(o,t){var r=this;return(0,f.A)(function*(){const a=(0,n.H9)(r.firestore,"posts",o);yield(0,_.c4)(r.firestore,function(){var u=(0,f.A)(function*(s){const c=yield s.get(a);if(c.exists()){const l=c.data(),i=l.likedBy||[],d=i.includes(t)?-1:1;s.update(a,{likes:(0,n.GV)(d),likedBy:i.includes(t)?(0,n.C3)(t):(0,n.hq)(t)}),r.updatePostInState(o,{likes:l.likes+d,likedBy:i.includes(t)?i.filter(g=>g!==t):[...i,t]})}else console.log("Post does not exist.")});return function(s){return u.apply(this,arguments)}}())})()}updatePostInState(o,t){const a=this.postsSubject.getValue().map(u=>u.id===o?{...u,...t}:u);this.postsSubject.next(a)}getPostLikes(o){var t=this;return(0,f.A)(function*(){var r;const a=(0,n.H9)(t.firestore,"posts",o);return(null===(r=(yield(0,n.x7)(a)).data())||void 0===r?void 0:r.likes)||0})()}userLikeThisPost(o){var t=this;return(0,f.A)(function*(){const r=yield t.getCurrentUser();if(r){const a=(0,n.H9)(t.firestore,"posts",o),u=yield(0,n.x7)(a);if(u.exists())return(u.data().likedBy||[]).includes(r.uid)}return!1})()}loadSeparateUsersPost(o){var t=this;return(0,f.A)(function*(){try{const r=(0,_.rJ)(t.firestore,"posts"),a=(0,n.P)(r,(0,n._M)("uid","==",o)),u=yield(0,n.GG)(a);return yield Promise.all(u.docs.map(function(){var c=(0,f.A)(function*(l){const i=l.data(),d=i.uid,g=yield t.loadUserDetail(d);return{id:l.id,...i,...g}});return function(l){return c.apply(this,arguments)}}()))}catch(r){return console.error("Error loading posts:",r),null}})()}logout(){return localStorage.removeItem("user"),this.router.navigate(["/login"],{replaceUrl:!0}),this.auth.signOut()}savePost(o,t){var r=this;return(0,f.A)(function*(){const a=(0,_.rJ)(r.firestore,"savedPosts");return yield(0,_.gS)(a,{uid:o,postId:t})})()}StoreNotification(o){var t=this;return(0,f.A)(function*(){try{const r=(0,_.rJ)(t.firestore,"Notifications");yield(0,_.gS)(r,{title:o.title,message:o.body,timestamp:o.timestamp}),console.log("Notification stored successfully")}catch(r){console.error("Error storing notification: ",r)}})()}followUser(o){var t=this;return(0,f.A)(function*(){const r=yield t.getCurrentUser();if(!r)return void console.error("No current user found.");const a=yield t.isFollowing(o),u=(0,_.rJ)(t.firestore,"users"),s=(0,n.P)(u,(0,n._M)("uid","==",o)),c=yield(0,n.GG)(s);if(!c.empty){const l=c.docs[0];if(a){yield(0,n.mZ)(l.ref,{followersCount:(0,n.GV)(-1),followers:(0,n.C3)(r.uid)});const i=(0,n.P)(u,(0,n._M)("uid","==",r.uid)),d=yield(0,n.GG)(i);if(!d.empty){const g=d.docs[0];yield(0,n.mZ)(g.ref,{followingCount:(0,n.GV)(-1),following:(0,n.C3)(o)}),console.log("Successfully unfollowed the user.")}}else{yield(0,n.mZ)(l.ref,{followersCount:(0,n.GV)(1),followers:(0,n.hq)(r.uid)});const i=(0,n.P)(u,(0,n._M)("uid","==",r.uid)),d=yield(0,n.GG)(i);if(!d.empty){const g=d.docs[0];yield(0,n.mZ)(g.ref,{followingCount:(0,n.GV)(1),following:(0,n.hq)(o)}),console.log("Successfully followed the user.")}}}})()}isFollowing(o){var t=this;return(0,f.A)(function*(){const r=yield t.getCurrentUser();if(!r||!r.uid)return!1;const a=yield(0,n.GG)((0,n.P)((0,_.rJ)(t.firestore,"users"),(0,n._M)("uid","==",r.uid)));return a.empty?(console.error("Current user document not found."),!1):(a.docs[0].data().following||[]).includes(o)})()}sendResetLink(o){var t=this;return(0,f.A)(function*(){console.log(o);try{yield(0,h.J1)(t.auth,o),console.log("Password reset email sent!")}catch(r){console.error("Error sending password reset email:",r)}})()}sendVerificationEmail(o){return(0,h.gA)(o)}isEmailVerified(o){return o.emailVerified}reloadUser(o){return o.reload()}}return(y=M).\u0275fac=function(o){return new(o||y)(e.KVO(h.Nj),e.KVO(_._7),e.KVO(C.Ix))},y.\u0275prov=e.jDH({token:y,factory:y.\u0275fac,providedIn:"root"}),M})()}}]);