"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[6336],{6336:(G,U,p)=>{p.r(U),p.d(U,{RegisterPage:()=>S});var u=p(467),E=p(177),a=p(4341),r=p(2220),b=p(6766),e=p(4438),j=p(8287),A=p(9350);const D=()=>["/login"];function O(s,v){1&s&&(e.j41(0,"p"),e.EFF(1,"Username is required"),e.k0s())}function F(s,v){1&s&&(e.j41(0,"p"),e.EFF(1," Username must be at least 2 characters and can only contain letters, numbers, and underscores "),e.k0s())}function n(s,v){if(1&s&&(e.j41(0,"ion-item",8)(1,"ion-label",17),e.DNE(2,O,2,0,"p",18)(3,F,2,0,"p",18),e.k0s()()),2&s){e.XpG();const c=e.sdS(15);e.R7$(2),e.Y8G("ngIf",null==c.errors?null:c.errors.required),e.R7$(),e.Y8G("ngIf",null==c.errors?null:c.errors.pattern)}}function t(s,v){1&s&&(e.j41(0,"p"),e.EFF(1,"Email is required"),e.k0s())}function o(s,v){1&s&&(e.j41(0,"p"),e.EFF(1,"Please enter a valid email"),e.k0s())}function i(s,v){if(1&s&&(e.j41(0,"ion-item",8)(1,"ion-label",17),e.DNE(2,t,2,0,"p",18)(3,o,2,0,"p",18),e.k0s()()),2&s){e.XpG();const c=e.sdS(19);e.R7$(2),e.Y8G("ngIf",null==c.errors?null:c.errors.required),e.R7$(),e.Y8G("ngIf",null==c.errors?null:c.errors.email)}}function l(s,v){1&s&&(e.j41(0,"p"),e.EFF(1,"Phone number is required"),e.k0s())}function g(s,v){1&s&&(e.j41(0,"p"),e.EFF(1," Phone number must be between 10 and 15 digits "),e.k0s())}function d(s,v){if(1&s&&(e.j41(0,"ion-item",8)(1,"ion-label",17),e.DNE(2,l,2,0,"p",18)(3,g,2,0,"p",18),e.k0s()()),2&s){e.XpG();const c=e.sdS(23);e.R7$(2),e.Y8G("ngIf",null==c.errors?null:c.errors.required),e.R7$(),e.Y8G("ngIf",null==c.errors?null:c.errors.pattern)}}function f(s,v){1&s&&(e.j41(0,"p"),e.EFF(1,"Password is required"),e.k0s())}function _(s,v){1&s&&(e.j41(0,"p"),e.EFF(1," Password must be at least 6 characters "),e.k0s())}function m(s,v){1&s&&(e.j41(0,"p"),e.EFF(1," Password must contain letters, numbers, and special characters "),e.k0s())}function C(s,v){if(1&s&&(e.j41(0,"ion-item",8)(1,"ion-label",17),e.DNE(2,f,2,0,"p",18)(3,_,2,0,"p",18)(4,m,2,0,"p",18),e.k0s()()),2&s){e.XpG();const c=e.sdS(27);e.R7$(2),e.Y8G("ngIf",null==c.errors?null:c.errors.required),e.R7$(),e.Y8G("ngIf",null==c.errors?null:c.errors.minlength),e.R7$(),e.Y8G("ngIf",null==c.errors?null:c.errors.pattern)}}let S=(()=>{var s;class v{constructor(P,y,M){this.firebaseService=P,this.router=y,this.toastController=M,this.name="",this.email="",this.password="",this.phone=""}register(){var P=this;return(0,u.A)(function*(){try{const M=(yield P.firebaseService.createUser(P.email,P.password)).user,R=null==M?void 0:M.uid;yield P.firebaseService.storeUserDetails(P.name,P.phone,P.email,R),yield P.firebaseService.sendVerificationEmail(M),yield(yield P.toastController.create({message:"A verification email has been sent to your email. Please verify and then login.",duration:5e3,position:"top"})).present(),P.router.navigate(["/login"])}catch(y){yield(yield P.toastController.create({message:"Error: "+(y||"Enter Valid Details!"),duration:5e3,position:"top"})).present()}})()}ngOnInit(){}}return(s=v).\u0275fac=function(P){return new(P||s)(e.rXU(j.f),e.rXU(b.Ix),e.rXU(A.K_))},s.\u0275cmp=e.VBU({type:s,selectors:[["app-register"]],standalone:!0,features:[e.aNF],decls:37,vars:11,consts:[["registerForm","ngForm"],["usernameCtrl","ngModel"],["emailCtrl","ngModel"],["phoneCtrl","ngModel"],["passwordCtrl","ngModel"],["mode","ios"],[1,"ion-padding"],[1,"ion-text-center"],["lines","none"],["size","large","mode","md",1,"ion-text-center"],["label","Username","labelPlacement","floating","name","username","required","","pattern","^[A-Za-z0-9_]{2,}$",3,"ngModelChange","ngModel"],["lines","none",4,"ngIf"],["label","Email","labelPlacement","floating","name","email","type","email","required","","email","",3,"ngModelChange","ngModel"],["label","Phone Number","labelPlacement","floating","name","phone","type","tel","required","","pattern","^\\d{10,15}$",3,"ngModelChange","ngModel"],["label","Password","type","password","labelPlacement","floating","name","password","required","","minlength","6","pattern","(?=.*[0-9])(?=.*[A-Za-z])(?=.*[!@#$%^&*])[A-Za-z\\d!@#$%^&*]{6,}",3,"ngModelChange","ngModel"],["color","primary","size","default","expand","block","type","submit",3,"click","disabled"],[3,"routerLink"],["color","danger"],[4,"ngIf"]],template:function(P,y){if(1&P){const M=e.RV6();e.j41(0,"ion-content",5)(1,"ion-header",6)(2,"ion-label",7)(3,"h1"),e.EFF(4,"vibo"),e.k0s(),e.j41(5,"p"),e.EFF(6,"Feel the Vibe, Share the Moment"),e.k0s()()(),e.j41(7,"form",null,0)(9,"ion-list",6)(10,"ion-item",8)(11,"ion-title",9),e.EFF(12,"Register"),e.k0s()(),e.j41(13,"ion-item")(14,"ion-input",10,1),e.mxI("ngModelChange",function(h){return e.eBV(M),e.DH7(y.name,h)||(y.name=h),e.Njj(h)}),e.k0s()(),e.DNE(16,n,4,2,"ion-item",11),e.j41(17,"ion-item")(18,"ion-input",12,2),e.mxI("ngModelChange",function(h){return e.eBV(M),e.DH7(y.email,h)||(y.email=h),e.Njj(h)}),e.k0s()(),e.DNE(20,i,4,2,"ion-item",11),e.j41(21,"ion-item")(22,"ion-input",13,3),e.mxI("ngModelChange",function(h){return e.eBV(M),e.DH7(y.phone,h)||(y.phone=h),e.Njj(h)}),e.k0s()(),e.DNE(24,d,4,2,"ion-item",11),e.j41(25,"ion-item")(26,"ion-input",14,4),e.mxI("ngModelChange",function(h){return e.eBV(M),e.DH7(y.password,h)||(y.password=h),e.Njj(h)}),e.k0s()(),e.DNE(28,C,5,3,"ion-item",11),e.j41(29,"ion-item",8)(30,"ion-button",15),e.bIt("click",function(){return e.eBV(M),e.Njj(y.register())}),e.EFF(31,"Register"),e.k0s()(),e.j41(32,"div",6)(33,"ion-label"),e.EFF(34,"Already have an account? "),e.j41(35,"a",16),e.EFF(36,"Login"),e.k0s()()()()()()}if(2&P){const M=e.sdS(8),R=e.sdS(15),h=e.sdS(19),I=e.sdS(23),k=e.sdS(27);e.R7$(14),e.R50("ngModel",y.name),e.R7$(2),e.Y8G("ngIf",R.invalid&&R.touched),e.R7$(2),e.R50("ngModel",y.email),e.R7$(2),e.Y8G("ngIf",h.invalid&&h.touched),e.R7$(2),e.R50("ngModel",y.phone),e.R7$(2),e.Y8G("ngIf",I.invalid&&I.touched),e.R7$(2),e.R50("ngModel",y.password),e.R7$(2),e.Y8G("ngIf",k.invalid&&k.touched),e.R7$(2),e.Y8G("disabled",M.invalid),e.R7$(5),e.Y8G("routerLink",e.lJ4(10,D))}},dependencies:[r.$w,b.Wk,r.nf,r.uz,r.Jm,r.he,r.W9,r.eU,r.BC,E.MD,E.bT,a.YN,a.qT,a.BC,a.cb,a.YS,a.xh,a.R_,a.Dg,a.vS,a.cV],styles:["ion-content[_ngcontent-%COMP%]{--background: url(DarkBackground.3fc41cd67dc01970.png) no-repeat center center / cover}ion-content[_ngcontent-%COMP%]   ion-label[_ngcontent-%COMP%]{font-family:League Spartan,sans-serif}ion-content[_ngcontent-%COMP%]   ion-label[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{font-size:54px;color:#fff;margin-top:40px}ion-content[_ngcontent-%COMP%]   ion-list[_ngcontent-%COMP%]{position:fixed;bottom:0;width:100%;height:75vh;border-top-left-radius:46px;border-top-right-radius:46px;display:flex;flex-direction:column;align-items:center;justify-content:center}ion-content[_ngcontent-%COMP%]   ion-list[_ngcontent-%COMP%]   ion-item[_ngcontent-%COMP%]{width:100%}ion-content[_ngcontent-%COMP%]   ion-list[_ngcontent-%COMP%]   ion-button[_ngcontent-%COMP%]{margin:30px auto}"]}),v})()},8287:(G,U,p)=>{p.d(U,{f:()=>A});var u=p(467),E=p(4665),a=p(9967),r=p(3273),b=p(4412),e=p(4438),j=p(6766);let A=(()=>{var D;class O{constructor(n,t,o){this.auth=n,this.firestore=t,this.router=o,this.postsSubject=new b.t([]),this.posts$=this.postsSubject.asObservable(),this.commentsSubject=new b.t([]),this.comments$=this.commentsSubject.asObservable(),this.getCurrentUser()}createUser(n,t){return(0,E.eJ)(this.auth,n,t)}loginUser(n,t){return(0,E.x9)(this.auth,n,t)}storeUserDetails(n,t,o,i){var l=this;return(0,u.A)(function*(){const g=(0,a.rJ)(l.firestore,"users");return yield(0,a.gS)(g,{name:n,phoneNumber:t,email:o,uid:i,followersCount:0,followingCount:0,userName:n,profilePic:"https://media.istockphoto.com/id/1397556857/vector/avatar-13.jpg?s=612x612&w=0&k=20&c=n4kOY_OEVVIMkiCNOnFbCxM0yQBiKVea-ylQG62JErI="})})()}getCurrentUser(){return new Promise(n=>{(0,E.hg)(this.auth,t=>{t&&localStorage.setItem("user",JSON.stringify(t)),n(t)})})}loadUserDetail(n){var t=this;return(0,u.A)(function*(){try{const o=(0,a.rJ)(t.firestore,"users"),i=(0,r.P)(o,(0,r._M)("uid","==",n)),g=(yield(0,r.GG)(i)).docs.map(d=>d.data());return g.length>0?g[0]:null}catch(o){return console.error("Error loading user details:",o),null}})()}loadPost(){var n=this;return(0,u.A)(function*(){try{const t=(0,a.rJ)(n.firestore,"posts");(0,r.aQ)(t,function(){var o=(0,u.A)(function*(i){const l=yield Promise.all(i.docs.map(function(){var g=(0,u.A)(function*(d){const f=d.data(),_=yield n.loadUserDetail(f.uid);return{id:d.id,...f,..._}});return function(d){return g.apply(this,arguments)}}()));l.sort((g,d)=>{var f,_;const m=(null===(f=g.createdAt)||void 0===f?void 0:f.toMillis())||0;return((null===(_=d.createdAt)||void 0===_?void 0:_.toMillis())||0)-m}),n.postsSubject.next(l)});return function(i){return o.apply(this,arguments)}}())}catch(t){console.error("Error loading posts:",t)}})()}postComment(n,t,o){var i=this;return(0,u.A)(function*(){const l=(0,a.rJ)(i.firestore,"comments");return yield(0,a.gS)(l,{uid:n,postId:t,comment:o})})()}loadComments(n){var t=this;return(0,u.A)(function*(){try{const o=(0,a.rJ)(t.firestore,"comments"),i=(0,r.P)(o,(0,r._M)("postId","==",n));(0,r.aQ)(i,function(){var l=(0,u.A)(function*(g){const d=yield Promise.all(g.docs.map(function(){var f=(0,u.A)(function*(_){const m=_.data(),C=yield t.loadUserDetail(m.uid);return{...m,...C}});return function(_){return f.apply(this,arguments)}}()));t.commentsSubject.next(d)});return function(g){return l.apply(this,arguments)}}())}catch(o){console.error("Error loading comments:",o)}})()}loadSavedPost(n){var t=this;return(0,u.A)(function*(){const o=(0,a.rJ)(t.firestore,"savedPosts"),i=(0,r.P)(o,(0,r._M)("uid","==",n)),l=yield(0,r.GG)(i);return(yield Promise.all(l.docs.map(function(){var d=(0,u.A)(function*(f){const m=f.data().postId,C=(0,r.H9)(t.firestore,`posts/${m}`),S=yield(0,r.x7)(C);if(S.exists()){const s=S.data(),v=s.uid,c=yield t.loadUserDetail(v);return{...s,...c}}return console.log(`Post with ID ${m} does not exist.`),null});return function(f){return d.apply(this,arguments)}}()))).filter(d=>null!==d)})()}toggleLikePost(n,t){var o=this;return(0,u.A)(function*(){const i=(0,r.H9)(o.firestore,"posts",n);yield(0,a.c4)(o.firestore,function(){var l=(0,u.A)(function*(g){const d=yield g.get(i);if(d.exists()){const f=d.data(),_=f.likedBy||[],m=_.includes(t)?-1:1;g.update(i,{likes:(0,r.GV)(m),likedBy:_.includes(t)?(0,r.C3)(t):(0,r.hq)(t)}),o.updatePostInState(n,{likes:f.likes+m,likedBy:_.includes(t)?_.filter(C=>C!==t):[..._,t]})}else console.log("Post does not exist.")});return function(g){return l.apply(this,arguments)}}())})()}updatePostInState(n,t){const i=this.postsSubject.getValue().map(l=>l.id===n?{...l,...t}:l);this.postsSubject.next(i)}getPostLikes(n){var t=this;return(0,u.A)(function*(){var o;const i=(0,r.H9)(t.firestore,"posts",n);return(null===(o=(yield(0,r.x7)(i)).data())||void 0===o?void 0:o.likes)||0})()}userLikeThisPost(n){var t=this;return(0,u.A)(function*(){const o=yield t.getCurrentUser();if(o){const i=(0,r.H9)(t.firestore,"posts",n),l=yield(0,r.x7)(i);if(l.exists())return(l.data().likedBy||[]).includes(o.uid)}return!1})()}loadSeparateUsersPost(n){var t=this;return(0,u.A)(function*(){try{const o=(0,a.rJ)(t.firestore,"posts"),i=(0,r.P)(o,(0,r._M)("uid","==",n)),l=yield(0,r.GG)(i);return yield Promise.all(l.docs.map(function(){var d=(0,u.A)(function*(f){const _=f.data(),m=_.uid,C=yield t.loadUserDetail(m);return{id:f.id,..._,...C}});return function(f){return d.apply(this,arguments)}}()))}catch(o){return console.error("Error loading posts:",o),null}})()}logout(){return localStorage.removeItem("user"),this.router.navigate(["/login"],{replaceUrl:!0}),this.auth.signOut()}savePost(n,t){var o=this;return(0,u.A)(function*(){const i=(0,a.rJ)(o.firestore,"savedPosts");return yield(0,a.gS)(i,{uid:n,postId:t})})()}StoreNotification(n){var t=this;return(0,u.A)(function*(){try{const o=(0,a.rJ)(t.firestore,"Notifications");yield(0,a.gS)(o,{title:n.title,message:n.body,timestamp:n.timestamp}),console.log("Notification stored successfully")}catch(o){console.error("Error storing notification: ",o)}})()}followUser(n){var t=this;return(0,u.A)(function*(){const o=yield t.getCurrentUser();if(!o)return void console.error("No current user found.");const i=yield t.isFollowing(n),l=(0,a.rJ)(t.firestore,"users"),g=(0,r.P)(l,(0,r._M)("uid","==",n)),d=yield(0,r.GG)(g);if(!d.empty){const f=d.docs[0];if(i){yield(0,r.mZ)(f.ref,{followersCount:(0,r.GV)(-1),followers:(0,r.C3)(o.uid)});const _=(0,r.P)(l,(0,r._M)("uid","==",o.uid)),m=yield(0,r.GG)(_);if(!m.empty){const C=m.docs[0];yield(0,r.mZ)(C.ref,{followingCount:(0,r.GV)(-1),following:(0,r.C3)(n)}),console.log("Successfully unfollowed the user.")}}else{yield(0,r.mZ)(f.ref,{followersCount:(0,r.GV)(1),followers:(0,r.hq)(o.uid)});const _=(0,r.P)(l,(0,r._M)("uid","==",o.uid)),m=yield(0,r.GG)(_);if(!m.empty){const C=m.docs[0];yield(0,r.mZ)(C.ref,{followingCount:(0,r.GV)(1),following:(0,r.hq)(n)}),console.log("Successfully followed the user.")}}}})()}isFollowing(n){var t=this;return(0,u.A)(function*(){const o=yield t.getCurrentUser();if(!o||!o.uid)return!1;const i=yield(0,r.GG)((0,r.P)((0,a.rJ)(t.firestore,"users"),(0,r._M)("uid","==",o.uid)));return i.empty?(console.error("Current user document not found."),!1):(i.docs[0].data().following||[]).includes(n)})()}sendResetLink(n){var t=this;return(0,u.A)(function*(){console.log(n);try{yield(0,E.J1)(t.auth,n),console.log("Password reset email sent!")}catch(o){console.error("Error sending password reset email:",o)}})()}sendVerificationEmail(n){return(0,E.gA)(n)}isEmailVerified(n){return n.emailVerified}reloadUser(n){return n.reload()}}return(D=O).\u0275fac=function(n){return new(n||D)(e.KVO(E.Nj),e.KVO(a._7),e.KVO(j.Ix))},D.\u0275prov=e.jDH({token:D,factory:D.\u0275fac,providedIn:"root"}),O})()}}]);