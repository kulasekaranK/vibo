"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[904],{904:(U,y,_)=>{_.r(y),_.d(y,{ForgotPasswordPage:()=>E});var d=_(467),p=_(177),a=_(4341),n=_(2220),s=_(4438),P=_(8287),M=_(9350);function D(t,e){1&t&&(s.j41(0,"p"),s.EFF(1,"Email is required"),s.k0s())}function h(t,e){1&t&&(s.j41(0,"p"),s.EFF(1,"Please enter a valid email"),s.k0s())}function v(t,e){if(1&t&&(s.j41(0,"ion-item",5)(1,"ion-label",10),s.DNE(2,D,2,0,"p",11)(3,h,2,0,"p",11),s.k0s()()),2&t){s.XpG();const o=s.sdS(15);s.R7$(2),s.Y8G("ngIf",null==o.errors?null:o.errors.required),s.R7$(),s.Y8G("ngIf",null==o.errors?null:o.errors.email)}}let E=(()=>{var t;class e{constructor(r,i){this.service=r,this.toastController=i,this.email=""}ngOnInit(){}send(){var r=this;return(0,d.A)(function*(){try{console.log(r.email),yield r.service.sendResetLink(r.email),(yield r.toastController.create({message:"Password reset link sent successfully, please check your inbox!",duration:5e3,position:"top",mode:"ios"})).present()}catch{(yield r.toastController.create({message:"Error sending password reset link!",duration:5e3,position:"top",mode:"ios"})).present()}})()}}return(t=e).\u0275fac=function(r){return new(r||t)(s.rXU(P.f),s.rXU(M.K_))},t.\u0275cmp=s.VBU({type:t,selectors:[["app-forgot-password"]],standalone:!0,features:[s.aNF],decls:20,vars:3,consts:[["loginForm","ngForm"],["emailCtrl","ngModel"],["mode","ios"],[1,"ion-padding"],[1,"ion-text-center"],["lines","none"],["size","large","mode","md",1,"ion-text-center"],["label","Enter email","labelPlacement","floating","name","email","required","","email","",3,"ngModelChange","ngModel"],["lines","none",4,"ngIf"],["color","tertiary","size","default","expand","block","type","submit",3,"click","disabled"],["color","danger"],[4,"ngIf"]],template:function(r,i){if(1&r){const c=s.RV6();s.j41(0,"ion-content",2)(1,"ion-header",3)(2,"ion-label",4)(3,"h1"),s.EFF(4,"vibo"),s.k0s(),s.j41(5,"p"),s.EFF(6,"Feel the Vibe, Share the Moment"),s.k0s()()(),s.j41(7,"form",null,0)(9,"ion-list",3)(10,"ion-item",5)(11,"ion-title",6),s.EFF(12,"Reset Password"),s.k0s()(),s.j41(13,"ion-item")(14,"ion-input",7,1),s.mxI("ngModelChange",function(u){return s.eBV(c),s.DH7(i.email,u)||(i.email=u),s.Njj(u)}),s.k0s()(),s.DNE(16,v,4,2,"ion-item",8),s.j41(17,"ion-item",5)(18,"ion-button",9),s.bIt("click",function(){return s.eBV(c),s.Njj(i.send())}),s.EFF(19,"Send Reset Link"),s.k0s()()()()()}if(2&r){const c=s.sdS(8),l=s.sdS(15);s.R7$(14),s.R50("ngModel",i.email),s.R7$(2),s.Y8G("ngIf",l.invalid&&l.touched),s.R7$(2),s.Y8G("disabled",c.invalid)}},dependencies:[n.$w,n.nf,p.MD,p.bT,a.YN,a.qT,a.BC,a.cb,a.YS,a.Dg,a.vS,a.cV,n.he,n.uz,n.Jm,n.W9,n.eU,n.BC],styles:["ion-content[_ngcontent-%COMP%]{--background: url(DarkBackground.3fc41cd67dc01970.png) no-repeat center center / cover}ion-content[_ngcontent-%COMP%]   ion-label[_ngcontent-%COMP%]{font-family:League Spartan,sans-serif}ion-content[_ngcontent-%COMP%]   ion-label[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{font-size:54px;color:#fff;margin-top:100px}ion-content[_ngcontent-%COMP%]   ion-list[_ngcontent-%COMP%]{position:fixed;bottom:0;width:100%;height:65vh;border-top-left-radius:46px;border-top-right-radius:46px;display:flex;flex-direction:column;align-items:center;justify-content:center}ion-content[_ngcontent-%COMP%]   ion-list[_ngcontent-%COMP%]   ion-item[_ngcontent-%COMP%]{width:100%}ion-content[_ngcontent-%COMP%]   ion-list[_ngcontent-%COMP%]   ion-button[_ngcontent-%COMP%]{margin:30px auto}"]}),e})()},8287:(U,y,_)=>{_.d(y,{f:()=>D});var d=_(467),p=_(4665),a=_(9967),n=_(3273),s=_(4412),P=_(4438),M=_(6766);let D=(()=>{var h;class v{constructor(t,e,o){this.auth=t,this.firestore=e,this.router=o,this.postsSubject=new s.t([]),this.posts$=this.postsSubject.asObservable(),this.commentsSubject=new s.t([]),this.comments$=this.commentsSubject.asObservable(),this.getCurrentUser()}createUser(t,e){return(0,p.eJ)(this.auth,t,e)}loginUser(t,e){return(0,p.x9)(this.auth,t,e)}storeUserDetails(t,e,o,r){var i=this;return(0,d.A)(function*(){const c=(0,a.rJ)(i.firestore,"users");return yield(0,a.gS)(c,{name:t,phoneNumber:e,email:o,uid:r,followersCount:0,followingCount:0,userName:t,profilePic:"https://media.istockphoto.com/id/1397556857/vector/avatar-13.jpg?s=612x612&w=0&k=20&c=n4kOY_OEVVIMkiCNOnFbCxM0yQBiKVea-ylQG62JErI="})})()}getCurrentUser(){return new Promise(t=>{(0,p.hg)(this.auth,e=>{e&&localStorage.setItem("user",JSON.stringify(e)),t(e)})})}loadUserDetail(t){var e=this;return(0,d.A)(function*(){try{const o=(0,a.rJ)(e.firestore,"users"),r=(0,n.P)(o,(0,n._M)("uid","==",t)),c=(yield(0,n.GG)(r)).docs.map(l=>l.data());return c.length>0?c[0]:null}catch(o){return console.error("Error loading user details:",o),null}})()}loadPost(){var t=this;return(0,d.A)(function*(){try{const e=(0,a.rJ)(t.firestore,"posts");(0,n.aQ)(e,function(){var o=(0,d.A)(function*(r){const i=yield Promise.all(r.docs.map(function(){var c=(0,d.A)(function*(l){const u=l.data(),f=yield t.loadUserDetail(u.uid);return{id:l.id,...u,...f}});return function(l){return c.apply(this,arguments)}}()));i.sort((c,l)=>{var u,f;const g=(null===(u=c.createdAt)||void 0===u?void 0:u.toMillis())||0;return((null===(f=l.createdAt)||void 0===f?void 0:f.toMillis())||0)-g}),t.postsSubject.next(i)});return function(r){return o.apply(this,arguments)}}())}catch(e){console.error("Error loading posts:",e)}})()}postComment(t,e,o){var r=this;return(0,d.A)(function*(){const i=(0,a.rJ)(r.firestore,"comments");return yield(0,a.gS)(i,{uid:t,postId:e,comment:o})})()}loadComments(t){var e=this;return(0,d.A)(function*(){try{const o=(0,a.rJ)(e.firestore,"comments"),r=(0,n.P)(o,(0,n._M)("postId","==",t));(0,n.aQ)(r,function(){var i=(0,d.A)(function*(c){const l=yield Promise.all(c.docs.map(function(){var u=(0,d.A)(function*(f){const g=f.data(),m=yield e.loadUserDetail(g.uid);return{...g,...m}});return function(f){return u.apply(this,arguments)}}()));e.commentsSubject.next(l)});return function(c){return i.apply(this,arguments)}}())}catch(o){console.error("Error loading comments:",o)}})()}loadSavedPost(t){var e=this;return(0,d.A)(function*(){const o=(0,a.rJ)(e.firestore,"savedPosts"),r=(0,n.P)(o,(0,n._M)("uid","==",t)),i=yield(0,n.GG)(r);return(yield Promise.all(i.docs.map(function(){var l=(0,d.A)(function*(u){const g=u.data().postId,m=(0,n.H9)(e.firestore,`posts/${g}`),C=yield(0,n.x7)(m);if(C.exists()){const O=C.data(),S=O.uid,A=yield e.loadUserDetail(S);return{...O,...A}}return console.log(`Post with ID ${g} does not exist.`),null});return function(u){return l.apply(this,arguments)}}()))).filter(l=>null!==l)})()}toggleLikePost(t,e){var o=this;return(0,d.A)(function*(){const r=(0,n.H9)(o.firestore,"posts",t);yield(0,a.c4)(o.firestore,function(){var i=(0,d.A)(function*(c){const l=yield c.get(r);if(l.exists()){const u=l.data(),f=u.likedBy||[],g=f.includes(e)?-1:1;c.update(r,{likes:(0,n.GV)(g),likedBy:f.includes(e)?(0,n.C3)(e):(0,n.hq)(e)}),o.updatePostInState(t,{likes:u.likes+g,likedBy:f.includes(e)?f.filter(m=>m!==e):[...f,e]})}else console.log("Post does not exist.")});return function(c){return i.apply(this,arguments)}}())})()}updatePostInState(t,e){const r=this.postsSubject.getValue().map(i=>i.id===t?{...i,...e}:i);this.postsSubject.next(r)}getPostLikes(t){var e=this;return(0,d.A)(function*(){var o;const r=(0,n.H9)(e.firestore,"posts",t);return(null===(o=(yield(0,n.x7)(r)).data())||void 0===o?void 0:o.likes)||0})()}userLikeThisPost(t){var e=this;return(0,d.A)(function*(){const o=yield e.getCurrentUser();if(o){const r=(0,n.H9)(e.firestore,"posts",t),i=yield(0,n.x7)(r);if(i.exists())return(i.data().likedBy||[]).includes(o.uid)}return!1})()}loadSeparateUsersPost(t){var e=this;return(0,d.A)(function*(){try{const o=(0,a.rJ)(e.firestore,"posts"),r=(0,n.P)(o,(0,n._M)("uid","==",t)),i=yield(0,n.GG)(r);return yield Promise.all(i.docs.map(function(){var l=(0,d.A)(function*(u){const f=u.data(),g=f.uid,m=yield e.loadUserDetail(g);return{id:u.id,...f,...m}});return function(u){return l.apply(this,arguments)}}()))}catch(o){return console.error("Error loading posts:",o),null}})()}logout(){return localStorage.removeItem("user"),this.router.navigate(["/login"],{replaceUrl:!0}),this.auth.signOut()}savePost(t,e){var o=this;return(0,d.A)(function*(){const r=(0,a.rJ)(o.firestore,"savedPosts");return yield(0,a.gS)(r,{uid:t,postId:e})})()}StoreNotification(t){var e=this;return(0,d.A)(function*(){try{const o=(0,a.rJ)(e.firestore,"Notifications");yield(0,a.gS)(o,{title:t.title,message:t.body,timestamp:t.timestamp}),console.log("Notification stored successfully")}catch(o){console.error("Error storing notification: ",o)}})()}followUser(t){var e=this;return(0,d.A)(function*(){const o=yield e.getCurrentUser();if(!o)return void console.error("No current user found.");const r=yield e.isFollowing(t),i=(0,a.rJ)(e.firestore,"users"),c=(0,n.P)(i,(0,n._M)("uid","==",t)),l=yield(0,n.GG)(c);if(!l.empty){const u=l.docs[0];if(r){yield(0,n.mZ)(u.ref,{followersCount:(0,n.GV)(-1),followers:(0,n.C3)(o.uid)});const f=(0,n.P)(i,(0,n._M)("uid","==",o.uid)),g=yield(0,n.GG)(f);if(!g.empty){const m=g.docs[0];yield(0,n.mZ)(m.ref,{followingCount:(0,n.GV)(-1),following:(0,n.C3)(t)}),console.log("Successfully unfollowed the user.")}}else{yield(0,n.mZ)(u.ref,{followersCount:(0,n.GV)(1),followers:(0,n.hq)(o.uid)});const f=(0,n.P)(i,(0,n._M)("uid","==",o.uid)),g=yield(0,n.GG)(f);if(!g.empty){const m=g.docs[0];yield(0,n.mZ)(m.ref,{followingCount:(0,n.GV)(1),following:(0,n.hq)(t)}),console.log("Successfully followed the user.")}}}})()}isFollowing(t){var e=this;return(0,d.A)(function*(){const o=yield e.getCurrentUser();if(!o||!o.uid)return!1;const r=yield(0,n.GG)((0,n.P)((0,a.rJ)(e.firestore,"users"),(0,n._M)("uid","==",o.uid)));return r.empty?(console.error("Current user document not found."),!1):(r.docs[0].data().following||[]).includes(t)})()}sendResetLink(t){var e=this;return(0,d.A)(function*(){console.log(t);try{yield(0,p.J1)(e.auth,t),console.log("Password reset email sent!")}catch(o){console.error("Error sending password reset email:",o)}})()}sendVerificationEmail(t){return(0,p.gA)(t)}isEmailVerified(t){return t.emailVerified}reloadUser(t){return t.reload()}}return(h=v).\u0275fac=function(t){return new(t||h)(P.KVO(p.Nj),P.KVO(a._7),P.KVO(M.Ix))},h.\u0275prov=P.jDH({token:h,factory:h.\u0275fac,providedIn:"root"}),v})()}}]);